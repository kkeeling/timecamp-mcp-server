<!-- 
This file is automatically maintained by Claude Code to track project decisions and recent work.
It helps team members quickly understand the project context and continue where others left off.
Generated by Claude Code's stop hook - feel free to edit manually if needed.
-->

# Key Decisions

* [DEPRECATED] Decided to remove all other installation workflows and exclusively support the UV single-file `timecamp-server.py` script: deleted the `src` directory, legacy test files, `pyproject.toml`, `requirements.txt`, and related packaging artifacts.  
  Reason: Streamline the codebase, eliminate redundant code paths, and focus on a single, maintainable deployment method.
* Decided to publish the TimeCamp MCP server on PyPI as a setuptools package: add `pyproject.toml`, include a `LICENSE` file, create a `timecamp_mcp_server` package directory with `__init__.py` and `__main__.py` entry point (dynamically importing the existing `timecamp-server.py`), and update `README.md` with pip and uvx installation instructions.  
  Reason: Provide a standard Python distribution workflow, improve discoverability, and offer users both `pip install timecamp-mcp-server` and `uvx timecamp-mcp-server` options.
* Decided to provide a UV-based single-file script distribution (`timecamp-server.py`) with a PEP 723 inline header for declaring dependencies; updated README to recommend this UV-based approach as the primary method, while retaining the traditional package installation as a fallback.  
  Reason: Simplify deployment with no installation required, enable easy one-file sharing, and leverage UV’s automatic dependency management.
* Decided to upgrade FastMCP to version 2.8.0 (from 0.8.0) in `timecamp-server.py` to leverage its built-in conversion of resources and prompts into tools, ensuring full MCP client compatibility.  
  Reason: Most MCP clients only support tools, so converting resources and prompts to tools guarantees all functionality is exposed.
* Decided to implement explicit tool wrappers for resource endpoints within `timecamp-server.py`—`get_projects`, `get_timer_status`, `get_tasks`, and `get_timecamp_overview`—to expose resource functionality as tools for MCP clients that only support tools and do not make `resources/list` or `prompts/list` calls.  
  Reason: Work around widespread client limitations and ensure resource/prompts data is visible alongside tools.
* Decided to align TimeCampClient with official API endpoints by replacing `/time_entries` → `/entries` and `/timer_running` → `/timer`.  
  Reason: Official API uses `/entries` and `/timer`, preventing redirects and authentication issues.
* Decided to retain the “Bearer” prefix in the Authorization header (`Authorization: Bearer {token}`) as per official documentation.  
  Reason: The API docs explicitly require the 'Bearer' prefix for authentication.
* Decided to use the `/tasks` endpoint for fetching project data instead of a non-existent `/projects` endpoint.  
  Reason: TimeCamp’s API organizes projects, subprojects, and tasks hierarchically under `/tasks`, and there is no `/projects` endpoint.
* Decided to continue using the `/timer_running` endpoint instead of `/timer`.  
  Reason: `/timer_running` returns correct timer status while `/timer` returns 404.
* Decided to use base URL `https://app.timecamp.com` instead of `https://www.timecamp.com` for all API requests.  
  Reason: The `www` domain returned 404 errors.
* Decided to parse XML responses from the TimeCamp API by adding an `_xml_to_dict()` converter using `xml.etree.ElementTree`.  
  Reason: The API returns XML data rather than JSON, requiring XML parsing.
* Decided to replace references to the `id` key with `task_id` for TimeCamp API resources when parsing project and task identifiers.  
  Reason: The TimeCamp API returns `task_id` instead of `id`, and updating the parsing logic prevents KeyError exceptions and ensures correct resource identification.
* Decided to remove ambiguous `id` fallback in timer functions (e.g., `stop_timer`) to ensure strict use of `task_id` and prevent potential KeyError issues.  
  Reason: Ensures consistency across timer operations and aligns with API’s `task_id` identifier.
* Decided to remove `.claude/hook-state.json` from version control and add it to `.gitignore`: remove personal session metadata, protect developer privacy, and reduce pull request noise.
* Decided to add explicit error handling in the CLI entry point (`timecamp_mcp_server/__main__.py`) to verify that the `timecamp_module` has an `mcp` attribute with a `run` method before invocation, raising clear exceptions if missing.  
  Reason: Prevent unhandled attribute errors and improve debuggability when the MCP entry point is misconfigured or missing.

# Recent Work

* September 12, 2025 – Added error handling in `timecamp_mcp_server/__main__.py` to verify presence of the `mcp` attribute and its `run` method before invocation, raising clear exceptions for missing attributes to improve entry-point robustness.
* September 11, 2025 – Removed `.claude/hook-state.json` from git tracking and added it to `.gitignore` to protect developer privacy and clean up PR noise.
* September 10, 2025 – Verified uvx installation workflow: ran `uvx timecamp-mcp-server`, installed dependencies (FastMCP 2.10.6 among 46 packages), and confirmed the TimeCamp MCP Server started successfully.
* September 10, 2025 – Published `timecamp-mcp-server` v0.1.0 to PyPI using twine; package is now available at https://pypi.org/project/timecamp-mcp-server/0.1.0/.
* September 8, 2025 – Corrected author metadata in `pyproject.toml` and `LICENSE`: updated author name to “Keenan Keeling”, email to “kkeeling@gmail.com”, and copyright holder.

# Next Steps

* Deploy to production environment.
* Monitor performance metrics with the new caching system.
* Consider implementing more robust ETag generation with JSON serialization.
* Add comprehensive logging throughout the application.
* Create deployment documentation and Docker configuration.
* Set up monitoring and alerting for the MCP server.
* Test and verify that new tool wrappers appear correctly in Claude Code and other MCP clients.
* Evaluate migrating from FastMCP to the official `mcp` library for finer-grained protocol control.
* Rotate API token after testing.
* Update README to document XML response handling and base URL change.